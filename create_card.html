<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Creazione Schede Orchidee</title>
<style>
body {
  font-family: "Georgia", "Times New Roman", serif;
  background: #efe8d8;
  margin: 20px;
}

h1 {
  text-align: center;
  color: #3f4a3c;
}

form {
  background: #fdf9f0;
  padding: 15px;
  border: 1.5px solid #8b7d65;
  border-radius: 8px;
  margin-bottom: 20px;
}

form label {
  display: block;
  margin: 5px 0;
  color: #4b4b3a;
}

form input, form select, form textarea {
  width: 100%;
  padding: 4px 6px;
  margin-top: 2px;
  border-radius: 4px;
  border: 1px solid #8b7d65;
  background: #fffef9;
}

button {
  margin-top: 10px;
  padding: 6px 12px;
  border-radius: 4px;
  border: none;
  background: #8b7d65;
  color: #fff;
  cursor: pointer;
}

button:hover {
  background: #7a6d57;
}

/* Anteprima multipla */
#anteprimaMultipla {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
}

.label {
  width: 300px;
  height: 180px;
  padding: 10px;
  display: flex;
  justify-content: space-between;
  background: #fdf9f0;
  border: 1.5px solid #8b7d65;
  border-radius: 8px;
  box-shadow: inset 0 0 0 2px #e7dcc8;
}

.info {
  width: 65%;
}

.info h2 {
  font-size: 14pt;
  margin: 0 0 5px 0;
  font-style: italic;
  color: #3f4a3c;
}

.divider {
  margin: 4px 0;
  height: 1px;
  background: linear-gradient(to right, transparent, #8b7d65, transparent);
}

.info p {
  font-size: 10pt;
  margin: 2px 0;
  color: #4b4b3a;
}

.plant-name {
  font-weight: bold;
  font-style: italic;
}

.qr {
  width: 60px;
  height: 60px;
  border: 1.5px solid #8b7d65;
  border-radius: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
}
</style>
</head>

<body>

<h1>Crea le tue Schede Orchidee</h1>

<form id="schedaForm">
  <label>Nome botanico:
    <input type="text" id="nomeBotanico" placeholder="Es: Aerangis mystacidii">
  </label>
  <label>Nome della pianta:
    <input type="text" id="nomePianta" placeholder="Es: Mimi">
  </label>
  <label>Luce:
    <select id="luce">
      <option>media</option>
      <option>medio-alta</option>
      <option>bassa</option>
    </select>
  </label>
  <label>Umidità:
    <input type="text" id="umidita" placeholder="Es: 70–85%">
  </label>
  <label>Acqua:
    <select id="acqua">
      <option>Piovana</option>
      <option>Distillata</option>
      <option>Rubinetto decantato</option>
    </select>
  </label>
  <label>Note:
    <textarea id="note" rows="2" placeholder="Note aggiuntive"></textarea>
  </label>

  <button type="button" id="aggiungiScheda">Aggiungi Scheda</button>
</form>

<div id="anteprimaMultipla">
  <!-- Tutte le schede aggiunte appariranno qui -->
</div>

<button id="exportPDF">Esporta PDF</button>

<!-- Librerie -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

<script>
document.getElementById("aggiungiScheda").addEventListener("click", () => {
  const nomeBot = document.getElementById("nomeBotanico").value || "Nome botanico";
  const nomeP = document.getElementById("nomePianta").value || "Nome pianta";
  const luce = document.getElementById("luce").value;
  const umidita = document.getElementById("umidita").value || "--";
  const acqua = document.getElementById("acqua").value;
  const note = document.getElementById("note").value || "--";

  const container = document.createElement("div");
  container.className = "label";

  // Box info
  const infoDiv = document.createElement("div");
  infoDiv.className = "info";
  infoDiv.innerHTML = `
    <h2>${nomeBot}</h2>
    <div class="divider"></div>
    <p class="plant-name">Nome: ${nomeP}</p>
    <p>Luce: ${luce}</p>
    <p>Umidità: ${umidita}</p>
    <p>Acqua: ${acqua}</p>
    <p>Note: ${note}</p>
  `;

  // Box QR
  const qrDiv = document.createElement("div");
  qrDiv.className = "qr";

  container.appendChild(infoDiv);
  container.appendChild(qrDiv);

  document.getElementById("anteprimaMultipla").appendChild(container);

  // Genera QR dinamico in base64
  new QRCode(qrDiv, {
    text: "https://esempio.com/" + encodeURIComponent(nomeBot),
    width: 60,
    height: 60
  });

  // Reset form se vuoi
  document.getElementById("schedaForm").reset();
});

document.getElementById("exportPDF").addEventListener("click", () => {
  const element = document.getElementById("anteprimaMultipla");
  html2pdf()
    .set({
      margin: 10,
      filename: 'schede-orchidee.pdf',
      image: { type: 'jpeg', quality: 0.98 },
      html2canvas: { scale: 2 },
      jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
    })
    .from(element)
    .save();
});
</script>

</body>
</html>
